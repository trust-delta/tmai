# マルチエージェント監視

複数のAIエージェントを同時に監視・操作するワークフロー。

## tmaiの特徴：1パネル完結

tmaiは**アタッチ不要**で複数エージェントを操作できます。

```
┌─────────────────────────────────────────────────────────────┐
│ 一般的なツールの操作フロー                                   │
│                                                             │
│  監視画面 → アタッチ → 操作 → デタッチ → 監視画面          │
│                                                             │
│  問題：操作中は他のエージェントが見えない                   │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│ tmaiの操作フロー                                             │
│                                                             │
│  監視画面でそのまま操作                                      │
│  - y キーで承認                                              │
│  - 1-9 キーで選択肢を選択                                   │
│  - 全エージェントを常に監視しながら操作                     │
└─────────────────────────────────────────────────────────────┘
```

## セットアップ

### 方法1：既存のエージェントを監視

tmux上で複数のエージェントが動いていれば、tmaiが自動検出します。

```bash
# ウィンドウ1でClaude
tmux new-window -n agent1
claude

# ウィンドウ2でClaude（別プロジェクト）
tmux new-window -n agent2
cd ~/project-b && claude

# ウィンドウ3でtmai
tmux new-window -n monitor
tmai
```

### 方法2：tmaiから新規作成

tmaiのTUI内から新規エージェントを作成することもできます。

1. tmaiを起動
2. 新規プロセス作成（TUI内の操作）
3. 自動的にPTYラッピングで起動され、監視下に

## 操作方法

### エージェント間の移動

| キー | 動作 |
|------|------|
| `j` / `↓` | 次のエージェントへ |
| `k` / `↑` | 前のエージェントへ |

### 承認操作（アタッチ不要）

選択中のエージェントに対して直接操作：

| キー | 動作 |
|------|------|
| `y` | 承認（Yesを送信） |
| `1-9` | AskUserQuestionの選択肢を選択 |
| `Space` | 複数選択時のトグル |

### 直接入力が必要な場合

```
p キー → パススルーモード → 直接入力 → Esc で戻る
```

## 実践例：3エージェント同時開発

```
┌─────────────────────────────────────────────────────────────┐
│ tmux                                                        │
│                                                             │
│  Window 1: claude (feature-a)   ← 認証機能を実装中          │
│  Window 2: claude (feature-b)   ← API設計中                 │
│  Window 3: claude (bugfix)      ← バグ修正中                │
│  Window 4: tmai                 ← ここで全体を監視          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

tmaiの画面：

```
┌─ Agents ─────────────────┬─ Preview ────────────────────────┐
│                          │                                  │
│ ● feature-a [Approval]   │  Do you want to create           │
│   feature-b [Processing] │  src/auth/login.rs?              │
│   bugfix    [Idle]       │                                  │
│                          │  [Yes]  [No]                     │
│                          │                                  │
└──────────────────────────┴──────────────────────────────────┘
  → y キーで即座に承認、他のエージェントも見えたまま
```

## Agent Teams連携

Claude CodeのAgent Teams機能（複数エージェントがプロジェクトで協調作業）を使用する場合、tmaiでチーム構造とタスク進捗を可視化できます。

| キー | 動作 |
|------|------|
| `t` | 選択中のチームメンバーのタスクオーバーレイを表示 |
| `T` | チーム一覧画面（全チームとメンバー） |

大規模なチームで多数のエージェントを実行する場合に特に有用です。tmaiが全チームメンバーとタスク進捗を一つのダッシュボードで表示します。

詳細は[Agent Teams](../features/agent-teams.md)を参照。

## メリット

1. **コンテキストスイッチなし** - 全体を見ながら操作
2. **迅速な対応** - 承認待ちに即座に気づいて対応
3. **状況把握が容易** - どのエージェントが何をしているか一目瞭然

## 次のステップ

- [ワークツリーで並列開発](./worktree-parallel.md) - ブランチを分けて安全に並列開発
- [スマホから承認](./remote-approval.md) - 外出先からも承認操作
